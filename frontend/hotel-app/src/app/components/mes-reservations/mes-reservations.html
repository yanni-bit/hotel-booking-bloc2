<main class="reservations-page py-5">
  <div class="container">

    <h1 class="h3 mb-4 text-turquoise">
      <i class="bi bi-clock-history me-2"></i>Mes Réservations
    </h1>

    <!-- LOADING -->
    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border text-turquoise" role="status">
        <span class="visually-hidden">Chargement...</span>
      </div>
      <p class="mt-3">Chargement de vos réservations...</p>
    </div>

    <!-- ERROR -->
    <div *ngIf="error && !loading" class="alert alert-danger">
      <i class="bi bi-exclamation-triangle me-2"></i>{{ error }}
    </div>

    <!-- AUCUNE RÉSERVATION -->
    <div *ngIf="!loading && !error && reservations.length === 0" class="text-center py-5">
      <i class="bi bi-inbox" style="font-size: 4rem; color: var(--turquoise);"></i>
      <h2 class="h4 mt-3">Aucune réservation</h2>
      <p class="text-muted">Vous n'avez pas encore effectué de réservation.</p>
      <a [routerLink]="['/']" class="btn btn-primary mt-3">
        <i class="bi bi-search me-2"></i>Rechercher un hôtel
      </a>
    </div>

    <!-- LISTE DES RÉSERVATIONS -->
    <div *ngIf="!loading && !error && reservations.length > 0" class="row">

      <div class="col-12" *ngFor="let reservation of reservations">
        <div class="card border-0 shadow-sm mb-4 reservation-card">
          <div class="card-body p-4">
            <div class="row">

              <!-- IMAGE HÔTEL -->
              <div class="col-md-3">
                <img [src]="reservation.img_hotel" [alt]="reservation.nom_hotel" class="img-fluid rounded">
              </div>

              <!-- DÉTAILS -->
              <div class="col-md-6">
                <h3 class="h5 mb-2">{{ reservation.nom_hotel }}</h3>
                <p class="text-muted mb-2">
                  <i class="bi bi-geo-alt me-1"></i>
                  {{ reservation.ville_hotel }}, {{ reservation.pays_hotel }}
                </p>

                <div class="mb-2">
                  <strong>Chambre :</strong> {{ reservation.type_room }} - {{ reservation.cat_room }}
                </div>

                <div class="mb-2">
                  <strong>Offre :</strong> {{ reservation.nom_offre }}
                </div>

                <div class="mb-2">
                  <i class="bi bi-calendar3 me-1"></i>
                  <strong>Du</strong> {{ formatDate(reservation.check_in) }}
                  <strong>au</strong> {{ formatDate(reservation.check_out) }}
                  <span class="text-muted">({{ reservation.nbre_nuits }} nuit{{ reservation.nbre_nuits > 1 ? 's' : ''
                    }})</span>
                </div>

                <div class="mb-2">
                  <i class="bi bi-people me-1"></i>
                  {{ reservation.nbre_adults }} adulte{{ reservation.nbre_adults > 1 ? 's' : '' }}
                  <span *ngIf="reservation.nbre_children > 0">
                    , {{ reservation.nbre_children }} enfant{{ reservation.nbre_children > 1 ? 's' : '' }}
                  </span>
                </div>

                <div class="mt-3">
                  <span class="badge" [ngClass]="getStatusBadgeClass(reservation.couleur_statut)">
                    {{ reservation.nom_statut }}
                  </span>
                </div>
              </div>

              <!-- PRIX & ACTIONS -->
              <div class="col-md-3 text-md-end">
                <div class="mb-3">
                  <div class="text-muted small">Prix total</div>
                  <div class="h4 mb-0 text-turquoise">{{ reservation.total_price }}€</div>
                </div>

                <div class="mb-2">
                  <small class="text-muted">
                    N° confirmation :<br>
                    <strong>{{ reservation.num_confirmation }}</strong>
                  </small>
                </div>

                <div class="mt-3">
                  <small class="text-muted d-block">
                    Réservé le {{ formatDate(reservation.date_reservation) }}
                  </small>
                </div>

                <!-- BOUTONS ACTIONS -->
                <div class="mt-3 d-grid gap-2">
                  <!-- BOUTON VOIR DÉTAIL -->
                  <a [routerLink]="['/reservations', reservation.id_reservation]" 
                     class="btn btn-sm btn-primary w-100">
                    <i class="bi bi-eye me-1"></i>Voir le détail
                  </a>

                  <!-- BOUTON ANNULER -->
                  <button *ngIf="canCancel(reservation)" 
                          (click)="cancelReservation(reservation)" 
                          class="btn btn-sm btn-outline-danger w-100">
                    <i class="bi bi-x-circle me-1"></i>Annuler la réservation
                  </button>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>

    </div>

  </div>
</main>